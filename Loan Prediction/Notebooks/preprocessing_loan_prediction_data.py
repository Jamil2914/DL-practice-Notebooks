# -*- coding: utf-8 -*-
"""Preprocessing_Loan_Prediction_Data.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1GPwU-aByyXaLIvjMR21mcUNMD0iJYmJ6
"""

import pandas as pd

print(pd.__version__)

#reading the data
data = pd.read_csv('loan_data.csv')

data.shape

data.head()

data.dtypes

data.isnull().sum()

#Filling the missing values(categorical)
data['Gender'].fillna(data['Gender'].mode()[0],inplace = True)
data['Married'].fillna(data['Married'].mode()[0],inplace = True)
data['Dependents'].fillna(data['Dependents'].mode()[0],inplace = True)
data['Self_Employed'].fillna(data['Self_Employed'].mode()[0],inplace = True) 
data['Loan_Amount_Term'].fillna(data['Loan_Amount_Term'].mode()[0],inplace = True) 
data['Credit_History'].fillna(data['Credit_History'].mode()[0],inplace = True)

data.isnull().sum()

"""# Filling the missing values"""

#Filling the missing values(numerical)
data['LoanAmount'].fillna(data['LoanAmount'].mean(),inplace = True)

data.isnull().sum()

data.head()

"""# Converting categorical values to numerical values"""

data

data['Gender'] = data['Gender'].map({'Male' : 0 , 'Female' : 1})
data['Married'] = data['Married'].map({'Yes' : 0 , 'No' : 1})
data['Dependents'] = data['Dependents'].map({'0' : 0 , '1' : 1 , '2' : 2 , '3+' : 3})
data['Education'] = data['Education'].map({'Graduate' : 0 , 'Not Graduate' : 1 })
data['Self_Employed'] = data['Self_Employed'].map({'Yes' : 0 , 'No' : 1})
data['Property_Area'] = data['Property_Area'].map({'Urban' : 0 , 'Semiurban' : 1,'Rural' : 2})
data['Loan_Status'] = data['Loan_Status'].map({'Y' : 0 , 'N' : 1})

data.dtypes

data.head()

"""## Bringing all values ranging from 0 to 1
Xnorm = (X - Xmin) / (Xmax - Xmin)
"""

for i in data.columns[1:] :
  data[i] = (data[i] - data[i].min()) / (data[i].max() - data[i].min())

data['Dependents'] = (data['Dependents'] - data['Dependents'].min()) / (data['Dependents'].max() - data['Dependents'].min())

data.head()

data.to_csv('preprocessed_loan_data.csv',index = False)

